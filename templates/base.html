{% load static %}
<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Fuentes -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&family=Poppins:wght@300;400;500&family=Source+Serif+Pro:wght@400;600&display=swap"
    rel="stylesheet">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Estilos globales del layout/sidebar -->
  <link href="{% static 'css/sidebar.css' %}" rel="stylesheet">

  {% block extra_css %}{% endblock %}
  <title>{% block title %}GestDocu{% endblock %}</title>
</head>

<body>
  <!-- Sidebar -->
  <aside class="sidebar bg-dark text-white p-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3 class="m-0">GestDocu</h3>
      <button id="sidebarToggle" class="btn btn-outline-light btn-sm">
        <i class="fa fa-bars"></i>
      </button>
    </div>

    <div class="side-inner">
      <div class="profile text-center mb-3">
        <img src="{% static 'img/person_4.jpg' %}" alt="Avatar" class="img-fluid rounded-circle mb-2" width="80">
        <h5 class="name mb-0">{{ request.user.username|default:'Invitado' }}</h5>
        <small class="text-light-50">
          {% if request.user.is_authenticated and request.user.groups.all %}
          {{ request.user.groups.first.name }}
          {% else %}
          Sin rol
          {% endif %}
        </small>
      </div>

      <div class="nav-menu">
        <ul class="list-unstyled">

          <!-- Usuarios -->
          <li class="mb-2">
            <a href="{% url 'dashboard:panel' %}" class="btn w-100 text-start text-white">
              <i class="fa fa-user-shield me-2"></i> Dashboard
            </a>


            <button class="btn w-100 text-start text-white" type="button" data-bs-toggle="collapse"
              data-bs-target="#menuUsuarios">
              <i class="fa fa-user-shield me-2"></i> Gestionar Usuarios
            </button>
            <div id="menuUsuarios" class="collapse">
              <ul class="list-unstyled ps-3">
                <li><a href="{% url 'accounts:roles_list' %}" class="text-white text-decoration-none">Roles</a></li>
                <li><a href="{% url 'accounts:user_list' %}" class="text-white text-decoration-none">Usuarios</a></li>
                <li><a href="{% url 'accounts:user_create' %}" class="text-white text-decoration-none">Crear
                    Usuarios</a></li>
                <li><a href="{% url 'accounts:actors_list' %}" class="text-white text-decoration-none">Lista de
                    Actores</a></li>
              </ul>
            </div>
          </li>

          <!-- Clientes -->
          <li class="mb-2">
            <button class="btn w-100 text-start text-white" type="button" data-bs-toggle="collapse"
              data-bs-target="#menuClientes">
              <i class="fa fa-users me-2"></i> Gesti칩n de Clientes
            </button>
            <div id="menuClientes" class="collapse">
              <ul class="list-unstyled ps-3">
                <li><a href="#" class="text-white text-decoration-none">Lista de
                    Clientes</a></li>
                <li><a href="#" class="text-white text-decoration-none">Nuevo Cliente - Persona</a></li>
                <li><a href="#" class="text-white text-decoration-none">Nuevo Cliente - Empresa</a></li>
              </ul>
            </div>
          </li>

          <!-- Documentos -->
          <li class="mb-2">
            <button class="btn w-100 text-start text-white" type="button" data-bs-toggle="collapse"
              data-bs-target="#menuDocumentos">
              <i class="fa fa-folder-open me-2"></i> Gestionar Documentos
            </button>
            <div id="menuDocumentos" class="collapse">
              <ul class="list-unstyled ps-3">
                <li><a href="#" class="text-white text-decoration-none">Documentos</a></li>
                <li><a href="#" class="text-white text-decoration-none">Tipos de
                    Documento</a></li>
                <li><a href="#" class="text-white text-decoration-none">Relaciones Caso-Cliente</a>
                </li>
                <li><a href="#" class="text-white text-decoration-none">Visualizaci칩n
                    Jer치rquica</a></li>
              </ul>
            </div>
          </li>

          <!-- Casos -->
          <li class="mb-2">
            <button class="btn w-100 text-start text-white" type="button" data-bs-toggle="collapse"
              data-bs-target="#menuCasos">
              <i class="fa fa-briefcase me-2"></i> Gestionar Casos y Expedientes
            </button>
            <div id="menuCasos" class="collapse">
              <ul class="list-unstyled ps-3">
                <li><a href="#" class="text-white text-decoration-none">Casos</a></li>
                <li><a href="#" class="text-white text-decoration-none">Vista de Casos</a></li>
                <li><a href="#" class="text-white text-decoration-none">Expedientes</a></li>
                <li>
                  <a class="nav-link text-white" href="{% url 'dashboard:panel' %}">
                    <i class="fa fa-home me-2"></i> Dashboard
                  </a>
                </li>

                <li><a href="#" class="text-white text-decoration-none">Vista de
                    Expedientes</a></li>
              </ul>
            </div>
          </li>

          <!-- Logout -->
          <li class="mt-4">
            <form id="logout-form" action="{% url 'logout' %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-light w-100">
                <i class="fa fa-sign-out-alt me-2"></i> Cerrar Sesi칩n
              </button>
            </form>
          </li>
        </ul>
      </div>
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="p-4 flex-grow-1 bg-light" id="main-content">
    <div class="container-fluid">
      {% block content %}{% endblock %}
    </div>
  </main>

  <!-- Bootstrap 5 JS (incluye Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Script del sidebar -->
  <script src="{% static 'js/sidebar.js' %}"></script>

  {% block extra_js %}{% endblock %}

  <!-- Chat Widget Flotante (solo para usuarios autenticados) -->
  {% if user.is_authenticated %}
    {% include 'chat/chat_widget.html' %}
  {% endif %}
</body>

</html>