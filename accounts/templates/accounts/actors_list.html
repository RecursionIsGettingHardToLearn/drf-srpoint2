{% extends "base.html" %}
{% block title %}Actores{% endblock %}

{% block content %}
<div class="col-12">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="m-0">Lista de Actores</h3>
  </div>

  <!-- Filtro por tipo -->
  <form method="get" class="mb-4">
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <label class="form-label mb-0">Filtrar por tipo:</label>
      </div>
      <div class="col-auto">
        <select name="tipo" class="form-select form-select-sm" onchange="this.form.submit()">
          <option value="">Todos</option>
          <option value="ABOGADO" {% if tipo == 'ABOGADO' %}selected{% endif %}>Abogado</option>
          <option value="CLIENTE" {% if tipo == 'CLIENTE' %}selected{% endif %}>Cliente</option>
          <option value="ASISTENTE" {% if tipo == 'ASISTENTE' %}selected{% endif %}>Asistente</option>
        </select>
      </div>
    </div>
  </form>

  <!-- Tabla -->
  <div class="table-responsive">
    <table class="table table-sm table-hover align-middle shadow-sm">
      <thead class="table-light">
        <tr>
          <th>Tipo</th>
          <th>Nombre completo</th>
          <th>CI</th>
          <th>Teléfono</th>
          <th>Usuario</th>
          <th>Estado</th>
          <th>Datos específicos</th>
        </tr>
      </thead>
      <tbody>
        {% for item in actores_data %}
          {% with a=item.actor %}
          <tr>
            <td>{{ a.tipoActor }}</td>
            <td>{{ a.nombres }} {{ a.apellidoPaterno }} {{ a.apellidoMaterno }}</td>
            <td>{{ a.ci }}</td>
            <td>{{ a.telefono }}</td>
            <td>
              {% if a.usuario %}
                {{ a.usuario.username }}
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </td>
            <td>
              {% if a.estadoActor == "ACTIVO" %}
                <span class="badge bg-success">{{ a.estadoActor }}</span>
              {% else %}
                <span class="badge bg-secondary">{{ a.estadoActor }}</span>
              {% endif %}
            </td>
            <td>
              {% if item.info_completa %}
                <span class="badge bg-success">Completo</span>
              {% else %}
                <a href="{{ item.enlace_completar }}" class="btn btn-outline-warning btn-sm">
                  Completar datos
                </a>
              {% endif %}
            </td>
          </tr>
          {% endwith %}
        {% empty %}
          <tr>
            <td colspan="7" class="text-center text-muted py-3">
              No se encontraron actores.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
